import{r as t,h as i}from"./p-da09bae5.js";import{E as s,d as e,y as o,x as h}from"./p-ce686700.js";import{u as r}from"./p-e4433586.js";import{i as a}from"./p-06836bbf.js";const n=class{constructor(i){t(this,i),this.colorPickerHeight=200}handlewindowResize(){clearTimeout(this.resizeTimeout),this.resizeTimeout=setTimeout(()=>this.resizeColorPicker(),500)}resizeColorPicker(){this.colorPicker.resize(this.container.offsetWidth,this.colorPickerHeight)}componentDidLoad(){this.setUpColorPicker(),this.parameter.valueChanged.connect(t=>{this.onValueChange(t)}),this.onValueChange(s.USER_SETVALUE),setTimeout(()=>window.dispatchEvent(new Event("resize")),1e3)}onValueChange(t){this.change||(this.undoing=!0,this.colorPicker.color.rgb=this.parameter.getValue().getAsRGBDict(),this.undoing=!1,this.sampleColor=this.colorPicker.color.hslString,this.setSampleTextColor(),console.log(s),t==s.REMOTEUSER_SETVALUE&&(this.container.classList.add("user-edited"),this.remoteUserEditedHighlightId&&clearTimeout(this.remoteUserEditedHighlightId),this.remoteUserEditedHighlightId=setTimeout(()=>{this.container.classList.remove("user-edited"),this.remoteUserEditedHighlightId=null},1500)))}setSampleTextColor(){this.sampleTextColor=`hsl(1, 0%, ${100-this.colorPicker.color.hsl.l}%)`}setUpColorPicker(){this.colorPicker=a.ColorPicker(this.colorPickerContainer,{width:this.container.offsetWidth,height:this.colorPickerHeight,anticlockwise:!0,borderWidth:0,borderColor:"#fff",sliderHeight:"10px",padding:1,sliderMargin:4,handleRadius:4,layout:[{component:a.ui.Slider,options:{sliderType:"hue"}},{component:a.ui.Slider,options:{sliderType:"saturation"}},{component:a.ui.Slider,options:{}}]}),this.colorPicker.on("input:start",()=>{this.change=new e(this.parameter),this.appData.undoRedoManager.addChange(this.change)}),this.colorPicker.on("input:end",()=>{this.change=void 0}),this.colorPicker.on("color:change",()=>{if(this.undoing)return;const t=new o;t.setFromRGBDict(this.colorPicker.color.rgb),this.sampleColor=this.colorPicker.color.hslString,this.setSampleTextColor(),this.change?this.change.update({value:t}):(this.change=new e(this.parameter,t),this.appData.undoRedoManager.addChange(this.change))})}render(){return i("div",{ref:t=>this.container=t,class:"zea-param-widget-color"},i("div",{style:{color:this.sampleTextColor,backgroundColor:this.sampleColor},class:"color-sample"},this.sampleColor),i("div",{ref:t=>this.colorPickerContainer=t,class:"color-picker"}))}};r.registerWidget("zea-param-widget-color",t=>t.constructor.name==h.name),n.style=":host,input,button,select,textarea{font-family:'Roboto', sans-serif}.zea-param-widget-color{color:var(--color-foreground-1)}.color-sample{height:30px;line-height:30px;border:1px solid var(--color-foreground-1);margin-bottom:0.5em;text-align:center;font-size:0.8em}";export{n as Z}